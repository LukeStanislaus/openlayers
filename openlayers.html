
<html>
  <head>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.3.1/css/ol.css" type="text/css">
      <style>
          .map {
              height: 400px;
              width: 100%;
          }
      </style>
      <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.3.1/build/ol.js"></script>
      <title>OpenLayers example</title>
  </head>
  <body>
      <h2>My Map</h2>
      <div id="map" class="map"></div>
      <script>
  
          //import Feature from 'ol/Feature.js';
          var Feature = ol.Feature;
          //import Map from 'ol/Map.js';
          var Map = ol.Map;
          //import View from 'ol/View.js';
          var View = ol.View;
          //import Point from 'ol/geom/Point.js';
          var Point = ol.geom.Point;
  
          //import {Tile as TileLayer, Vector as VectorLayer} from 'ol/layer.js';
          var TileLayer = ol.layer.Tile;
          var VectorLayer = ol.layer.Vector;
  
          //import {Cluster, OSM, Vector as VectorSource} from 'ol/source.js';
          var Cluster = ol.source.Cluster;
          var OSM = ol.source.OSM;
          var VectorSource = ol.source.Vector;
  
          //="var " & B26 & "= ol.style." & B26 & ";"
          //import {Circle as CircleStyle, Fill, Stroke, Style, Text} from 'ol/style.js';
          var Circle = ol.style.Circle;
          var CircleStyle = ol.style.Circle;
          var Fill = ol.style.Fill;
          var Icon = ol.style.Icon;
          var Stroke = ol.style.Stroke;
          var Style = ol.style.Style;
          var Text = ol.style.Text;
  
  
  
          //import {Draw, Modify, Select, Snap} from 'ol/interaction.js';
          var Draw = ol.interaction.Draw;
          var Modify = ol.interaction.Modify;
          var Select = ol.interaction.Select;
          var Snap = ol.interaction.Snap;
  
  
          var locations1 = [
              //[51.658665, -1.92788,"0"],  // Mark : 0
              [51.657782, -1.929267, "1"],  // Mark : 1
              [51.658665, -1.92788, "2"],  // Mark : 2
              [51.659887, -1.927568, "3"],  // Mark : 3
              [51.660719, -1.92771, "4"],  // Mark : 4
              [51.66126, -1.930908, "5"],  // Mark : 5
              [51.66246, -1.933075, "6"],  // Mark : 6
              [51.662223, -1.934958, "7"],  // Mark : 7
              [51.66131, -1.935907, "8"],  // Mark : 8
              [51.659638, -1.933742, "9"],  // Mark : 9
              [51.659233, -1.930221, "Hut"],  // Mark : Hut
              [51.658144, -1.934895, "A"], //Mark : A
              [51.658112, -1.936521, "B"], //Mark : B
              [51.657318, -1.937959, "C"],//Mark : C
          ];
  
          var MarkNames = locations1.map(function (val) {
              return val[2];//.slice(2, 0);
          });
  
          var locations = locations1.map(function (val) {
              return val.slice(0, -1);
          });
  
          // OpenLayers uses [lon, lat], not [lat, lon]
          locations.map(function (l) {
              return l.reverse();
          });
  
          var route = new ol.geom.LineString(locations)
              .transform('EPSG:4326', 'EPSG:3857');
          var routeCoords = route.getCoordinates();
  
  
          //document.getElementById("Var1").innerHTML = routeCoords[0];
          //document.getElementById("Var2").innerHTML = center;
  
          var count = locations1.length;
          var Markfeatures = new Array(count);
          //var e = 4500000;
          for (var i = 0; i < count; ++i) {
              //var coordinates = [2 * e * Math.random() - e, 2 * e * Math.random() - e];
              Markfeatures[i] = new Feature({geometry: new Point(routeCoords[i]), name: locations1[i][2]});
          }
  
          var source = new VectorSource({
              features: Markfeatures //features
          });
  
  
          var styleCache = {};
          var Marks = new VectorLayer({
              source: source,
              style: function (feature) {
                  var size = 0;//feature.get('features').length;
                  var style = styleCache[size];
                  if (!style) {
                      style = new Style({
                          image: new CircleStyle({
                              radius: 10,
                              stroke: new Stroke({
                                  color: '#fff'
                              }),
                              fill: new Fill({
                                  color: '#3399CC'
                              })
                          }),
                          text: new Text({
                              text: feature.values_.name,
                              fill: new Fill({
                                  color: '#fff'
                              })
                          })
                      });
                      return style; // styleCache[size] = style;
                  }
                  // return style;
              }
          });
  
          var raster = new TileLayer({
              source: new OSM()
          });
  
          var source1 = new VectorSource();
  
          var styleFunction = function (feature) {
              var geometry = feature.getGeometry();
              var styles = [
                  // linestring
                  new Style({
                      stroke: new Stroke({
                          color: '#ffcc33',
                          width: 2
                      })
                  })
              ];
  
              geometry.forEachSegment(function (start, end) {
                  var dx = end[0] - start[0];
                  var dy = end[1] - start[1];
                  var mid = [start[0] + dx * 0.75, start[1] + dy * 0.75];
                  var rotation = Math.atan2(dy, dx);
                  // arrows
                  styles.push(new Style({
                      geometry: new Point(mid),
                      image: new Icon({
                          src: 'https://openlayers.org/en/v3.20.1/examples/data/arrow.png',
                          anchor: [0.75, 0.5],
                          rotateWithView: true,
                          rotation: -rotation
                      })
                  }));
              });
  
              return styles;
          };
          var vector1 = new VectorLayer({
              source: source1,
              style: styleFunction
          });
  
  
          var map = new Map({
              layers: [raster, vector1, Marks],
              target: 'map',
              view: new View({
                  center: routeCoords[2],//[0, 0],
                  zoom: 15
              })
          });
  
          map.addInteraction(new Draw({
              source: source1,
              type: 'LineString'
          }));
  
          // The snap interaction must be added after the Modify and Draw interactions
          // in order for its map browser event handlers to be fired first. Its handlers
          // are responsible of doing the snapping.
          var snap = new Snap({
              source: Marks.getSource()
          });
          map.addInteraction(snap);
  
  
      </script>
  </body>
  </html>